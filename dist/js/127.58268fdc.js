"use strict";(self["webpackChunkblog2024"]=self["webpackChunkblog2024"]||[]).push([[127],{1127:function(t,e,s){s.r(e),s.d(e,{default:function(){return k}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"Comment-Container"},[e("div",{staticClass:"bannerImg"},[e("HeadNav"),e("div",{staticClass:"title"},[t._v(" 留言板 ")])],1),e("div",{staticClass:"bacImg"},[e("div",{staticClass:"motto"},[e("CommentMotoo")],1),e("div",{staticClass:"list"},[e("CommentList")],1)])])},a=[],l=s(1755),o=function(){var t=this;t._self._c;return t._m(0)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"Motto-Container"},[e("div",{staticClass:"boder"},[e("p",[t._v("不应有恨 何事长向别时圆 "),e("br"),e("span",[t._v("--苏轼《水调歌头》")])])])])}],c=s(1656),r={},m=(0,c.A)(r,o,i,!1,null,null,null),p=m.exports,d=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"CommentList-Container"},[e("div",{staticClass:"postComment"},[e("el-row",{attrs:{gutter:12}},[e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:"QQ号(*必须)"},model:{value:t.postData.qq,callback:function(e){t.$set(t.postData,"qq",e)},expression:"postData.qq"}})],1),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:"昵称(选填)"},model:{value:t.postData.nickname,callback:function(e){t.$set(t.postData,"nickname",e)},expression:"postData.nickname"}})],1),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:"网站(选填)"}})],1)],1),e("el-row",{staticStyle:{"margin-top":"12px"}},[e("el-col",{attrs:{span:24}},[e("el-input",{attrs:{placeholder:"天青色等烟雨 留言板在等你"},model:{value:t.postData.content,callback:function(e){t.$set(t.postData,"content",e)},expression:"postData.content"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.PostBtn},slot:"append"},[t._v("发布")])],1)],1)],1)],1),e("div",{staticClass:"tittle tl"},[t._v(" 评论列表 | "),e("small",[t._v(t._s(this.total)+"条评论")])]),e("el-alert",{staticStyle:{"margin-top":"12px"},attrs:{title:"灌水的评论 我会删除的喔",type:"warning"}}),e("ul",{staticClass:"list"},[t._l(t.comment,(function(s){return e("li",{key:s.id,staticClass:"listItem tl"},[e("div",{staticClass:"avatar"}),e("div",{staticStyle:{width:"70%"}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"name"},[t._v(" "+t._s(s.name)+" ")])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"time"},[t._v(" "+t._s(s.time)+" ")])])],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"content"},[t._v(" "+t._s(s.content)+" ")])])],1)],1)])})),e("p",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]},[t._v("没有再多了")])],2)],1)},h=[],u={data(){return{comment:[],tempComment:[],total:0,postData:{qq:"",nickname:"",site:"",content:""},fullscreenLoading:!1,loading:!1}},created(){this.GetAll()},mounted(){window.addEventListener("scroll",this.handleScroll)},computed:{},methods:{GetAll(){return new Promise(((t,e)=>{fetch("http://124.221.138.245:40304/blog-comment/getAll",{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"}}).then((t=>t.json())).then((e=>{this.total=e.length,this.tempComment=e,this.comment=Array.isArray(e)?e.slice(0,4):[],t()})).catch((t=>{e(t)}))}))},handleScroll(){const t=document.documentElement.scrollHeight-window.innerHeight<=window.scrollY+1;t&&this.loadMore()},loadMore(){if(this.comment.length>=this.total)return void(this.loading=!0);console.log("加载");let t=this.comment.length,e=this.tempComment.slice(t,t+2);this.comment=[...this.comment,...e]},PostBtn(){""!=this.postData.qq?""!=this.postData.nickname?""!=this.postData.content?this.$confirm("确定发布吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:t=>{if("confirm"==t){this.fullscreenLoading=!0;const t="http://124.221.138.245:40304/blog-comment/post";fetch(`${t}?qq=${this.postData.qq}&name=${this.postData.nickname}&content=${this.postData.content}`,{method:"POST",headers:{Accept:"Application/json","Content-Type":"Application/json"}}).then((t=>t.text())).then((t=>{"Post success"==t?(this.GetAll(),setTimeout(function(){this.fullscreenLoading=!1,this.$message({message:"发送成功",type:"success"})}.bind(this),3e3)):setTimeout(function(){this.fullscreenLoading=!1,this.$message({message:"发送失败",type:"warning"})}.bind(this),3e3)}))}}}):this.$message({message:"内容为空",type:"warning"}):this.$message({message:"昵称为空",type:"warning"}):this.$message({message:"QQ为空",type:"warning"})}}},v=u,g=(0,c.A)(v,d,h,!1,null,null,null),f=g.exports,C={components:{HeadNav:l.A,CommentMotoo:p,CommentList:f}},w=C,_=(0,c.A)(w,n,a,!1,null,null,null),k=_.exports}}]);
//# sourceMappingURL=127.58268fdc.js.map